<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.07" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="NtrW9SjPOTvT69gBvl/fFw==" exportKeySalt="a98fe33c-c352-4b46-a054-b6787059df00" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String"><![CDATA[DATASTORE]]></Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[04841340-af98-452e-bcec-0485c599a651]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndExcludeExUnitBegin" type="java.lang.String">null</Field>
	<Field name="IndExcludeExUnitEnd" type="java.lang.String">null</Field>
	<Field name="IndExcludeExUnitMain" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapBegin" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapCleanup" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapEnd" type="java.lang.String">null</Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[1573]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmLang" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[ORACLE_BICS]]></Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[7]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[-1155942257]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String"><![CDATA[T]]></Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KI]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3de65d9a-4c39-4846-9ee3-627cc0ca3dac]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1573]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: IKM SQL to Oracle BI Cloud Service

AUTHOR: Oracle

Description :
    - Integration Knowledge Module For Oracle BI Cloud Service. This knowledge module allows to load metadata and data Oracle BI Cloud Service.
    - Please refer to the user guide for setup instructions.

OPTIONS (Refer to Option descriptions for more information on each option)

    - TRUNCATE_TARGET_TABLE: Whether to delete all data from the target before load. Valid only for Tables.
    - CREATE_TARGET: Whether to create the target before data load.
    - DROP_TARGET: Whether to drop the target before load. Applies to Tables and Datasets.
    - DATA_WRITE_MODE: The mode for inserting data into the target. Valid only for Tables.
    - NUM_RETRIES: Number of retry attempts if a batch execution fails.
    - RETRY_DELAY: Delay in seconds for retrying failed batch request.
    - REMOVE_DUPLICATES: Whether to remove duplicate data from within a batch. Valid only for Tables.
    - BATCH_SIZE: The number of rows to be sent in one REST call. Upper limit is 100000. Default value is 1000.
    - MAX_ERR_PER_BATCH: Maximum number of errors per batch insert. Supported only for Tables.
    - TRACE_FILE: Trace file for logging REST calls to BICS.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Edit Command]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_TRT_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[dff777d4-6611-4f86-bae7-8fde0cb565cc]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRUNCATE_TARGET_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Whether to delete all data from the target before load. Valid only for Tables.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ae0142d8-20f2-4f16-b809-f55faf086c52]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[CREATE_TARGET]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Whether to create the target before data load.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[98fdf1d4-abf7-4454-938a-cebeb8112526]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DROP_TARGET]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Whether to drop the target before load. Applies to Tables and Datasets.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[26d086ac-5d22-40ff-984e-022a5118ba85]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[1574]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[606]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[Insert all]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DATA_WRITE_MODE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[The mode for inserting data into the target. Valid only for Tables.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[90c82f92-7ed9-4726-82c2-c44f45c3aaf7]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1574]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Insert missing, Upsert, Insert all, Update only]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Text value]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_VALUE]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_USER_EXIT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c20b9060-ac62-4a56-bbf7-a2fd9928e446]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[607]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[NUM_RETRIES]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Number of retry attempts if a batch execution fails.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ae7075a9-c8e5-4e6c-9d9f-41b06a6d6a09]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[1575]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[608]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[RETRY_DELAY]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Delay in seconds for retrying failed batch request.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b3e482de-431f-48b9-8e7f-448766991295]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1575]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[26753578-f4db-4b40-a3ba-7c41b31c2426]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[REMOVE_DUPLICATES]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Whether to remove duplicate data from within a batch. Valid only for Tables.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[af3e23b0-4274-4950-b8a3-4b51381e9175]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[610]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[9]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1000]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[BATCH_SIZE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[The number of rows to be sent in one REST call. Upper limit is 100000.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8561fb8e-0e73-4fb4-815b-08aef59b4748]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[1576]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[611]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[MAX_ERR_PER_BATCH]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Maximum number of errors per batch insert. Supported only for Tables.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4a3538c6-0fdc-4e44-b268-05c4759e6a13]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1576]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExprITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[93761b38-9300-4d3e-b229-6db35bd74e64]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[612]]></Field>
	<Field name="IUserExitGroup" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[<?= java.lang.System.getProperty("java.io.tmpdir") ?>/bics_calls.log]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRACE_FILE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Trace file for logging REST calls to BICS.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1577]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE_BICS]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[48a3a155-ea7b-4426-8139-3d39cc6de4f4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[640]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Lock Journalized Table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[54be4271-fb3d-45a3-a5f9-f844eec43643]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1577]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ("C".equals(odiRef.getJrnInfo( "JRN_METHOD"))) { %> 
/* Consistant journalization detected. */
/* Lock should be done by a specific step in a package */ 
<% } else { %>
update	<%=odiRef.getTable( "L" , "JRN_NAME" , "A" )%>
set	JRN_CONSUMED = '1'
where (1=1)
<%=odiRef.getJrnFilter()%>
<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Source Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[COL_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1578]]></Field>
	<Field name="DefLanguage" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c4c1bad4-4455-4502-97d9-67ba4cba529e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[641]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop target]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[edb6fc5f-b5ea-46c4-b805-3cc359772ab0]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1578]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[import oracle.odi.runtime.rest.InternalInvokeRESTfulService;
import org.apache.commons.io.IOUtils;
import java.io.ByteArrayOutputStream;

import java.nio.file.Files;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;

void invokeRESTDropContainer(responseOutputStream) {
    def reqTemplateName = "tablename";
    def dropContainerOperation = "odi_bics_drop_table";
    def tableName = "<% out.print(tgtTable); %>";
    if("D".equalsIgnoreCase("<% out.print(tgtType); %>")) {
        reqTemplateName = "setname";
        dropContainerOperation = "odi_bics_drop_dataset";
    } else
        tableName = tableName.toUpperCase();

    def restCall = new InternalInvokeRESTfulService();

    odiRef.configureTool(restCall);
    restCall.setContext("<% out.print(bicsContext); %>");
    restCall.setLSchema("<% out.print(logicalSchema); %>");
    restCall.setOperation(dropContainerOperation);
    restCall.setResponseStream(responseOutputStream);

    def restParameters = new Vector();
    restParameters.add(["-HEADER.X-ID-TENANT-NAME", "<% out.print(bicsDomain); %>"] as String[]);
    restParameters.add(["-REQUEST_TEMPLATE." + reqTemplateName, tableName] as String[]);

    restCall.setParameters(restParameters);
    
    def traceLoc = "<% out.print(traceFileLoc); %>";
    if(! ("".equals(traceLoc) ) ) {
        restCall.setTraceStream(Files.newOutputStream(Paths.get(traceLoc), StandardOpenOption.CREATE, StandardOpenOption.APPEND));
    }

    
    restCall.execute(); 
}

ByteArrayOutputStream responseStream = new ByteArrayOutputStream(256);

invokeRESTDropContainer(responseStream);

odiRef.getLogger().log(java.util.logging.Level.INFO, "[Drop Target]" + responseStream.toString("UTF-8"));]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1579]]></Field>
	<Field name="DefLanguage" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e966f689-d441-4cd8-8e46-64743d452aea]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[642]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Truncate target table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[01e3b39c-1ad1-462e-a4f7-540ac3a8d1d4]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1579]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[import oracle.odi.runtime.rest.InternalInvokeRESTfulService;
import org.apache.commons.io.IOUtils;
import java.io.ByteArrayOutputStream;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;

void invokeRESTTruncateTable(responseOutputStream) {
    def truncateTableOperation = "odi_bics_table_truncate";
    def restCall = new InternalInvokeRESTfulService();
    odiRef.configureTool(restCall);
    restCall.setContext("<% out.print(bicsContext); %>");
    restCall.setLSchema("<% out.print(logicalSchema); %>");
    restCall.setOperation(truncateTableOperation);
    restCall.setResponseStream(responseOutputStream);
    def restParameters = new Vector();
    restParameters.add(["-HEADER.X-ID-TENANT-NAME", "<% out.print(bicsDomain); %>"] as String[]);
    restParameters.add(["-REQUEST_TEMPLATE.tablename", "<% out.print(tgtTable); %>".toUpperCase()] as String[]);

    restCall.setParameters(restParameters);

    def traceLoc = "<% out.print(traceFileLoc); %>";
    if(! ("".equals(traceLoc) ) ) {
        restCall.setTraceStream(Files.newOutputStream(Paths.get(traceLoc), StandardOpenOption.CREATE, StandardOpenOption.APPEND));
    }
    
    restCall.execute(); 
}

void logInfo (String message) {
    odiRef.getLogger().log(java.util.logging.Level.INFO, "[Truncate Target]" + message);
}

if ("T".equals("<% out.print(tgtType); %>")) {
    ByteArrayOutputStream responseStream = new ByteArrayOutputStream(256);
    invokeRESTTruncateTable(responseStream);
    
    logInfo(responseStream.toString("UTF-8")) ;
}]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1580]]></Field>
	<Field name="DefLanguage" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cdfdf150-6a7e-46dd-be49-9d39eaf00a0f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[643]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create target]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4e4c63ea-d73c-4f65-9ae1-9e1a56a0a7dd]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1580]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[import org.codehaus.jettison.json.JSONObject;
import org.codehaus.jettison.json.JSONArray;
import oracle.odi.runtime.rest.InternalInvokeRESTfulService;
import org.apache.commons.io.IOUtils;
import java.io.ByteArrayOutputStream;
import oracle.odi.runtime.rest.RestReqBodyPart;
import java.util.List;

import java.nio.file.Files;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;

def allColNames = "<%=odiRef.getAllTargetColList("[", "[COL_NAME]", ",", "]")%>";
def allColTypes = "<%=odiRef.getAllTargetColList("[", "[DEST_DT]", ",", "]")%>";
def allColScales = "<%=odiRef.getAllTargetColList("[", " [SCALE]", ",", "]")%>";
def allColLengths = "<%=odiRef.getAllTargetColList("[", " [LONGC]", ",", "]")%>";
def allColNullable = "<%=odiRef.getAllTargetColList("[", "[COL_MANDATORY]", ",", "]")%>";
def allColDefault = "<%=odiRef.getAllTargetColList("[", " [DEF_VALUE]", ",", "]")%>";
def allColPosition = "<%=odiRef.getAllTargetColList("[", "[POS]", ",", "]")%>";

void invokeRESTWithJson(requestInputStream, responseOutputStream) {
    def reqTemplateName = "tablename";
    def createContainerOperation = "odi_bics_create_table";
    if("D".equalsIgnoreCase("<% out.print(tgtType); %>")) {
        reqTemplateName = "setname";
        createContainerOperation = "odi_bics_create_dataset";
    }
    
    def restCall = new InternalInvokeRESTfulService();    
    odiRef.configureTool(restCall);
    
    restCall.setContext("<% out.print(bicsContext); %>");    
    restCall.setLSchema("<% out.print(logicalSchema); %>");
    restCall.setOperation(createContainerOperation);
    
    if("T".equals("<% out.print(tgtType); %>"))
        restCall.setRequestBodyStream(requestInputStream, "UTF-8");
    else {
        def reqJsonPart = new RestReqBodyPart("top", requestInputStream);
        reqJsonPart.setBodyPartContentType("application/json");
        restCall.setReqBodyPartDetails([reqJsonPart] as List);
    }
    restCall.setResponseStream(responseOutputStream);
    def restParameters = new Vector();
    restParameters.add(["-HEADER.X-ID-TENANT-NAME", "<% out.print(bicsDomain); %>"] as String[]);
    if("T".equals("<% out.print(tgtType); %>"))
        restParameters.add(["-HEADER.Content-Type", "application/json"] as String[]);
    else
        restParameters.add(["-HEADER.Content-Type", "multipart/mixed"] as String[]);
    restParameters.add(["-REQUEST_TEMPLATE." + reqTemplateName, "<% out.print(tgtTable); %>"] as String[]);

    restCall.setParameters(restParameters);

    def traceLoc = "<% out.print(traceFileLoc); %>";
    if(!"".equals(traceLoc)) {
        restCall.setTraceStream(Files.newOutputStream(Paths.get(traceLoc), StandardOpenOption.CREATE, StandardOpenOption.APPEND));
    }
    
    restCall.execute(); 
}


List getAsList(input) {
    if (input==null || "".equals(input))
    input = "[]";
    
    return input[1..-2].tokenize(',')*.toString();
}

class BICSTableModel {
    static final String COLUMN_NULLABLE_KEY = "nullable";
    static final String COLUMN_DEFAULT_VAL_KEY = "defaultValue";
    
    public JSONArray getTableCreationJson(columnNameList, columnDatatypeList, columnDatatypeLengthList,
		columnDatatypeScaleList, columnNullableList, columnDefaultValueList) {
        int numColumns = columnNameList.size();
	JSONArray columnsArray = new JSONArray();
	for(int i=0; i< numColumns; i++) {
            String columnName = columnNameList[i] == null ? "" : columnNameList[i].trim();
            String dataType = columnDatatypeList[i] == null ? "" : columnDatatypeList[i].trim();
            String datatypeLength = columnDatatypeLengthList[i] == null ? "" : columnDatatypeLengthList[i].trim();
            String datatypeScale = columnDatatypeScaleList[i] == null ? "" : columnDatatypeScaleList[i].trim();
            String isNullable = columnNullableList[i] == null ? "" : columnNullableList[i].trim();
            String defaultVal = columnDefaultValueList[i] == null ? "" : columnDefaultValueList[i].trim();
            if("".equals(columnName))
	        throw new OdiKMException("ODIKM-BICS-1000", "ODIKM-BICS-1000: Column missing name");
	    if("".equals(dataType))
	        throw new OdiKMException("ODIKM-BICS-1001", "ODIKM-BICS-1001: Column " + i + " missing datatype");
            JSONObject columnInfo = new JSONObject();
            columnInfo.put("<% out.print(COLUMN_NAME_KEY); %>", columnName);
            columnInfo.put("<% out.print(COLUMN_DT_KEY); %>", dataType);
            
            
            if("".equals(datatypeLength)) {
                datatypeLength = "VARCHAR".equalsIgnoreCase(dataType) ? 50 : 10;
            } 
            
            if("NUMBER".equalsIgnoreCase(dataType)) {
                columnInfo.put("<% out.print(COLUMN_DT_PRECISION_KEY); %>", datatypeScale);    
            } 
            
            if (!"".equalsIgnoreCase(datatypeLength))
                columnInfo.put("<% out.print(COLUMN_DT_LENGTH_KEY); %>", datatypeLength);
            
                
            columnInfo.put(COLUMN_NULLABLE_KEY, "0".equals(isNullable) ? "true" : "false");
            
            columnsArray.put(columnInfo);
        }
	return columnsArray;
    }
}

class BICSDatasetModel {
    
        public JSONObject getDatasetCreationJson(columnNameList, columnDatatypeList, columnDatatypeLengthList,
		columnDatatypePrecisionList, columnPositionList) {
            int numColumns = columnNameList.size();
            JSONObject dataLoadInformation = new JSONObject();
	    JSONArray columnsArray = new JSONArray();
	    for(int i=0; i< numColumns; i++) {
                String columnName = columnNameList[i] == null ? "" : columnNameList[i].trim();
                String dataType = columnDatatypeList[i] == null ? "" : columnDatatypeList[i].trim();
                String datatypeLength = columnDatatypeLengthList[i] == null ? "" : columnDatatypeLengthList[i].trim();
                String datatypePrecision = columnDatatypePrecisionList[i] == null ? "" : columnDatatypePrecisionList[i].trim();
                String columnPosition = columnPositionList[i] == null ? "null" : columnPositionList[i].trim();
                if("".equals(columnName))
	            throw new OdiKMException("ODIKM-BICS-1000", "ODIKM-BICS-1000: Column missing name");
	        if("".equals(dataType))
	            throw new OdiKMException("ODIKM-BICS-1001", "ODIKM-BICS-1001: Column " + i + " missing datatype");
                JSONObject columnInfo = new JSONObject();
                columnInfo.put("columnName", columnName);
                columnInfo.put("<% out.print(COLUMN_DT_KEY); %>", dataType);

                if("".equals(datatypeLength) || "0".equals(datatypeLength)) {
                    datatypeLength = "VARCHAR".equalsIgnoreCase(dataType) ? 50 : 10;
                }

                columnInfo.put("<% out.print(COLUMN_DT_LENGTH_KEY); %>", datatypeLength);

                if("NUMBER".equalsIgnoreCase(dataType)) {
                    columnInfo.put("<% out.print(COLUMN_DT_PRECISION_KEY); %>", "".equals(datatypePrecision) ? 
                        0 : datatypePrecision);
                } 

                columnInfo.put("<% out.print(COLUMN_POSITION_KEY); %>", columnPosition);
                columnsArray.put(columnInfo);
            }
            dataLoadInformation.put("columns", columnsArray);
            dataLoadInformation.put("<% out.print(DATASET_FIRST_BATCH); %>", "true");
            dataLoadInformation.put("<% out.print(DATASET_LAST_BATCH); %>", "true");
            dataLoadInformation.put("<% out.print(STREAM_DATA_TYPE_KEY); %>", "<% out.print(STREAM_DATA_TYPE_VAL);%>");

	    return dataLoadInformation;
     }
}

void logInfo (String message) {
    odiRef.getLogger().log(java.util.logging.Level.INFO, "[Create Target]" + message);
}

ByteArrayOutputStream responseStream = new ByteArrayOutputStream(1024);

if("T".equals("<% out.print(tgtType);%>")) {
    BICSTableModel bicsTableModel = new BICSTableModel();
    
    JSONArray json = bicsTableModel.getTableCreationJson(
        getAsList(allColNames), 
        getAsList(allColTypes), 
        getAsList(allColLengths), 
        getAsList(allColScales),
        getAsList(allColNullable), 
        getAsList(allColDefault));
    
    logInfo(json.toString());
        
    invokeRESTWithJson(IOUtils.toInputStream(json.toString(), "UTF-8"), responseStream);
    
} else {
    BICSDatasetModel bicsDatasetModel = new BICSDatasetModel();
                
    JSONObject json = bicsDatasetModel.getDatasetCreationJson(
        getAsList(allColNames), 
        getAsList(allColTypes), 
        getAsList(allColLengths), 
        getAsList(allColScales), 
        getAsList(allColPosition));

    logInfo("(dataset)" + json.toString());

    invokeRESTWithJson(IOUtils.toInputStream(json.toString(), "UTF-8"), responseStream);

}

logInfo (responseStream.toString("UTF-8"));]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1581]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE_BICS]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[32f2b0bf-8ba2-4182-9a37-aa929d775e9f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[644]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Cleanup Journalized Table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[82f5dac7-a7f0-49cd-b2e5-67f7eeff1ad1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1581]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ("C".equals(odiRef.getJrnInfo( "JRN_METHOD"))) { %> 
/* Consistant journalization detected. */
/* Lock should be done by a specific step in a package */ 
<% } else { %>
delete from <%=odiRef.getTable("L","JRN_NAME","A")%>
where 	JRN_CONSUMED = '1'
<%=odiRef.getJrnFilter()%>
<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1582]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e9906a23-078b-493c-bad6-bc96148a4056]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[645]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Prepare for loading]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[20c9c7bc-2bbd-4a30-8025-ab58c5274a5c]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1582]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%
String maxErrorsPerBatch = odiRef.getOption("MAX_ERR_PER_BATCH");
String numRetries = odiRef.getOption("NUM_RETRIES");

String createTarget = odiRef.getOption("CREATE_TARGET_TABLE");
String createIndexes = odiRef.getOption("CREATE_INDEXES");
String dropTarget = odiRef.getOption("DROP_TARGET");
String truncateTarget = odiRef.getOption("TRUNCATE_TARGET_TABLE");

String removeDuplicates = odiRef.getOption("REMOVE_DUPLICATES");
String batchSize = odiRef.getOption("BATCH_SIZE");
String validateColumns = odiRef.getOption("VALIDATE_COLUMNS");
String dataWriteMode = odiRef.getOption("DATA_WRITE_MODE");
String tgtTable = odiRef.getTable("L", "TARG_NAME", "A");
String traceFileLoc = odiRef.getOption("TRACE_FILE");
String retryDelay = odiRef.getOption("RETRY_DELAY");
if("0".equals(retryDelay) || "".equals(retryDelay))
    retryDelay = 5;

if("".equals(maxErrorsPerBatch))
    maxErrorsPerBatch = "0";

String tgtType = odiRef.getInfo("DEST_PSCHEMA_BICS_TARGETTYPE");

static final String COLUMN_NAME_KEY = "columnName";
static final String COLUMN_DT_KEY = "dataType";
static final String COLUMN_DT_LENGTH_KEY = "length";
static final String COLUMN_DT_PRECISION_KEY = "precision";
static final String COLUMN_POSITION_KEY = "position";
static final String STREAM_DATA_TYPE_KEY = "optionalStreamType";
static final String STREAM_DATA_TYPE_VAL = "Java";
static final String DATASET_FIRST_BATCH = "firstBatch";
static final String DATASET_LAST_BATCH = "lastBatch";
static final String MISSING_VAL = "";
        
logicalSchema = odiRef.getInfo("DEST_LSCHEMA_NAME"); 
bicsContext = odiRef.getContext("CTX_CODE");
String bicsDomain  = odiRef.getInfo("DEST_CONNECT_BICS_ID_DOMAIN");
%>

def isValid = true;]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1583]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ae3857b7-6d4c-4a83-b088-1b67a4c9c19f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[646]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2019-01-27 15:32:34.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Load data into Oracle BICS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2d32cc45-f292-4f61-ae0d-5cc5e3d4fe85]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[1583]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%
pkColumns= odiRef.getTargetColList("[", "[COL_NAME]", ",","]", "PK");
ukColumns= odiRef.getTargetColList("[", "[COL_NAME]", ",","]", "UK");
%>

import oracle.odi.runtime.rest.InternalInvokeRESTfulService;
import org.codehaus.jettison.json.JSONObject;
import org.codehaus.jettison.json.JSONArray;
import org.apache.commons.io.IOUtils;

import java.io.ByteArrayOutputStream;
import java.io.ByteArrayInputStream;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;

import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;

import groovy.transform.Field;
import oracle.odi.runtime.rest.RestReqBodyPart;

@Field String STATS = "stats";
@Field String STATS_STATUS = "status";
@Field String STATS_INSERTED_ROWS = "insertedRows";
@Field String STATS_UPDATED_ROWS = "updatedRows";
@Field String STATS_FAILED_ROWS = "failedRows";
@Field String STATS_START_TIME = "startTime";
@Field String STATS_END_TIME = "endTime";

def tgtColNames = "<%=odiRef.getTargetColList("[", "[COL_NAME]", ",", "]")%>"; 
def tgtColPKs = "<%=odiRef.getTargetColList("[", "[COL_NAME]", ",", "]","PK")%>"; //for Table columnMap
def tgtColUKs = "<%=odiRef.getTargetColList("[", "[COL_NAME]", ",", "]","UK")%>"; //for Table columnMap
def tgtColTypes = "<%=odiRef.getTargetColList("[", "[DEST_DT]", ",", "]")%>"; //for Dataset
def tgtColScales = "<%=odiRef.getTargetColList("[", "[SCALE]", ",", "]")%>"; //for Dataset
def tgtColLengths = "<%=odiRef.getTargetColList("[", "[LONGC]", ",", "]")%>"; //for Dataset
def tgtColPositions = "<%=odiRef.getTargetColList("[", "[POS]", ",", "]")%>";

def removeDupTableData = "1".equals("<% out.print(removeDuplicates);%>");
@Field String dataLoadOperation = "odi_bics_table_update_data";
@Field String tableName = "<% out.print(tgtTable); %>";
@Field String reqTemplateName = "tablename";

if("T".equals("<% out.print(tgtType);%>")) {
    if("Insert all".equalsIgnoreCase("<% out.print(dataWriteMode);%>") || 
            "Insert missing".equalsIgnoreCase("<% out.print(dataWriteMode);%>")) {
        dataLoadOperation = "odi_bics_table_insert_data";
    }
    tableName = tableName.toUpperCase();
} else {
    dataLoadOperation = "odi_bics_dataset_insert_data";
    reqTemplateName = "setname";
}

String convertExceptionToString(Throwable ex) {
    java.io.StringWriter sw= new java.io.StringWriter();
    java.io.PrintWriter pw = new java.io.PrintWriter(sw);
    ex.printStackTrace(pw);
    return sw.getBuffer().toString();
}
        
void invokeRESTSendData(reqStructurePart, reqContentPart, responseOutputStream) {
    def restCall = new InternalInvokeRESTfulService();

    odiRef.configureTool(restCall);
    restCall.setContext("<% out.print(bicsContext); %>");
    restCall.setLSchema("<% out.print(logicalSchema); %>");
    restCall.setOperation(dataLoadOperation);
    restCall.setResponseStream(responseOutputStream);
    def reqList = [reqStructurePart, reqContentPart];
    restCall.setReqBodyPartDetails(reqList);
    def restParameters = new Vector();
    restParameters.add(["-HEADER.X-ID-TENANT-NAME", "<% out.print(bicsDomain); %>"] as String[]);
    restParameters.add(["-REQUEST_TEMPLATE." + reqTemplateName, tableName] as String[]);
    restCall.setParameters(restParameters);

    def traceLoc = "<% out.print(traceFileLoc); %>";
    if(! ("".equals(traceLoc) ) ) {
        restCall.setTraceStream(Files.newOutputStream(Paths.get(traceLoc), StandardOpenOption.CREATE, StandardOpenOption.APPEND));
    }
    
    restCall.execute();       
}

void logInfo (String message) {
    odiRef.getLogger().log(java.util.logging.Level.INFO, "[Load Target]" + message);
}

List getAsList(input) {
    if (input==null || "".equals(input))
    input = "[]";
    
    return input[1..-2].tokenize(',')*.toString();
}

class BICSDataLoadTableModel {

    public JSONObject getDataloadTableJson(expressionList, columnNameList, columnPositionList, columnPKs, columnUKs, columnFKs, removeDupTableData) {

        int numExpressionss = expressionList.size();

        JSONObject dataLoadInformation = new JSONObject();
        int numColumns = columnNameList.size();

	JSONArray columnMaps = new JSONArray();
	for(int i=0; i< numColumns; i++) {
        
            //check for any mapping expresson for the column
            if (expressionList[i] == null || expressionList[i] == "0")
                continue;
        
            JSONObject dataloadColumnMap = new JSONObject();
            String columnName = columnNameList[i] == null ? "" : columnNameList[i].trim();
            
            if("".equals(columnName))
	        throw new OdiKMException("ODIKM-BICS-1000", "ODIKM-BICS-1000: Column missing name");
            JSONObject columnInfo = new JSONObject();
            columnInfo.put("name", columnName);
            
            def partOfUniqueKey = "false";
            if(columnPKs.indexOf(columnName)>-1 || columnUKs.indexOf(columnName)>-1)
                partOfUniqueKey = "true";

            columnInfo.put("partOfUniqueKey", partOfUniqueKey);


            dataloadColumnMap.put("column", columnInfo);            
            dataloadColumnMap.put("<% out.print(COLUMN_POSITION_KEY); %>", Integer.parseInt(expressionList[i]));
 
            columnMaps.put(dataloadColumnMap);                                  
        }
        
	dataLoadInformation.put("columnMaps", columnMaps);
        dataLoadInformation.put("optionalMaximumErrors", "<% out.print(maxErrorsPerBatch);%>");
	dataLoadInformation.put("<% out.print(STREAM_DATA_TYPE_KEY); %>", "<% out.print(STREAM_DATA_TYPE_VAL);%>");
	dataLoadInformation.put("optionalWriteMode", "<% out.print(dataWriteMode);%>");
	dataLoadInformation.put("removeDuplicates", removeDupTableData);
	return dataLoadInformation;
    }
}

class BICSDataLoadDatasetModel {
    
    public JSONObject getDataloadDatasetJson(expressionList, columnNameList, columnDatatypeList, columnDatatypeLengthList,
                           columnDatatypePrecisionList, columnPositionList, isFirstBatch, isLastBatch) {

        int numExpressionss = expressionList.size();
          
        int numColumns = columnNameList.size();
        JSONObject dataLoadInformation = new JSONObject();
	JSONArray columnsArray = new JSONArray();
	for(int i=0; i< numColumns; i++) {

            //check for any mapping expresson for the column
            if (expressionList[i] == "0")
                continue;

            String columnName = columnNameList[i] == null ? "" : columnNameList[i].trim();
            String dataType = columnDatatypeList[i] == null ? "" : columnDatatypeList[i].trim();
            String datatypeLength = columnDatatypeLengthList[i] == null ? "" : columnDatatypeLengthList[i].trim();
            String datatypePrecision = columnDatatypePrecisionList[i] == null ? "" : columnDatatypePrecisionList[i].trim();
            String columnPosition = columnPositionList[i] == null ? "null" : columnPositionList[i].trim();
            if("".equals(columnName))
	        throw new OdiKMException("ODIKM-BICS-1000", "ODIKM-BICS-1000: Column missing name");
	    if("".equals(dataType))
	        throw new OdiKMException("ODIKM-BICS-1001", "ODIKM-BICS-1001: Column " + i + " missing datatype");
            JSONObject columnInfo = new JSONObject();
            columnInfo.put("columnName", columnName);
            columnInfo.put("<% out.print(COLUMN_DT_KEY); %>", dataType);
            if("".equals(datatypeLength) || "0".equals(datatypeLength)) {
                datatypeLength = "VARCHAR".equalsIgnoreCase(dataType) ? 50 : 10;
            }
            columnInfo.put("<% out.print(COLUMN_DT_LENGTH_KEY); %>", datatypeLength);
            columnInfo.put("<% out.print(COLUMN_DT_PRECISION_KEY); %>", "".equals(datatypePrecision) ? 
                    0 : datatypePrecision);
            //columnInfo.put("<% out.print(COLUMN_POSITION_KEY); %>", columnPosition);

            columnInfo.put("<% out.print(COLUMN_POSITION_KEY); %>", Integer.parseInt(expressionList[i]));

            columnsArray.put(columnInfo);
        }
        dataLoadInformation.put("columns", columnsArray);
        dataLoadInformation.put("<% out.print(DATASET_FIRST_BATCH); %>", isFirstBatch);
        dataLoadInformation.put("<% out.print(DATASET_LAST_BATCH); %>", isLastBatch);
        dataLoadInformation.put("<% out.print(STREAM_DATA_TYPE_KEY); %>", "<% out.print(STREAM_DATA_TYPE_VAL);%>");
	return dataLoadInformation;
    }
}

def batchSize = "<% out.print(batchSize);%>";
batchSize = batchSize.isInteger() ? batchSize.toInteger() : 1000;
if(batchSize >= 1000000) {
    batchSize = 1000000;
}
def numRetries = "<% out.print(numRetries);%>";
numRetries = numRetries.isInteger() ? numRetries.toInteger() : 0;

def retryDelaySecs = "<% out.print(retryDelay); %>";
retryDelaySecs = retryDelaySecs.isInteger() ? retryDelaySecs.toInteger() : 1;

@Field int numRecordsFromResultSet = 0;

List<Object[]> getNextBatch(data, batchSz, resultSetColumnNames) throws Exception {
    int recordCount = 0;
    numRecordsFromResultSet = 0;
    ArrayList<Object[]> recs = new ArrayList<Object[]>();
    while (recordCount < batchSz && data.next()) {
        Object[] o = new Object[resultSetColumnNames.length];
        for (int i = 0; i < resultSetColumnNames.length; i++) {
            o[i] = data.getObject(resultSetColumnNames[i]);
        }
        recs.add(o);
        recordCount++;
    }
    numRecordsFromResultSet = recordCount;
        
    return recs;
}
        
String[] getResultSetColumnNames(ResultSet rs) throws SQLException {
    ResultSetMetaData rsmd = rs.getMetaData();
    int colCount = rsmd.getColumnCount();
    String[] cols = new String[colCount];
    for (int i = 0; i < colCount; i++) {
        cols[i] = rsmd.getColumnLabel(i + 1);
    }
    return cols;
}

byte[] getBytes(List<Object[]> recs) throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(baos);
    for (int i = 0; i < recs.size(); i++) {
        oos.writeObject(recs.get(i));
    }
    oos.flush();
    oos.close();
    return baos.toByteArray();
}



def expressionTargetMappingPositions = "[";
String[] stagingExpressions = "<%=odiRef.getTargetColList("", "[EXPRESSION]", ",", "")%>".split(",");
int expressionMappingCount = 0;
for (String expression : stagingExpressions) {
    if (expression!=null && !expression.equals("")) {
        expressionMappingCount++;
         expressionTargetMappingPositions += expressionMappingCount + ",";
    } else
        expressionTargetMappingPositions+= "0,";
        
}	
expressionTargetMappingPositions += "]";

def sql= 'select <%=odiRef.getPop("DISTINCT_ROWS") %>  <%=odiRef.getColList("", "[EXPRESSION]", ",", "", "INS and !TRG") %> from <%=odiRef.getFrom() %>  where 	(1=1) <%=odiRef.getFilter() %> <%=odiRef.getJrnFilter() %> <%=odiRef.getJoin() %> <%=odiRef.getGrpBy() %> <%=odiRef.getHaving() %>'
def srcConn = odiRef.getJDBCConnection("SRC");
def stmt = srcConn.createStatement();

def srcFetchSize = <?if("".equals(odiRef.getInfo("SRC_FETCH_ARRAY"))){out.print("1000");}else{out.print(odiRef.getInfo("SRC_FETCH_ARRAY"));}?>;

stmt.setFetchSize(srcFetchSize);
def rs = stmt.executeQuery(sql);

String[] rsColNames = getResultSetColumnNames(rs);
StringBuilder recStats = new StringBuilder();
recStats.append("{ \"stats\" : [");

JSONObject reqData;
if("T".equalsIgnoreCase("<% out.print(tgtType); %>")) {

    pkColumns = "<% out.print(pkColumns); %>";
    ukColumns = "<% out.print(ukColumns); %>";

    def tableSendModel = new BICSDataLoadTableModel();
    reqData = tableSendModel.getDataloadTableJson(getAsList(expressionTargetMappingPositions), getAsList(tgtColNames), getAsList(tgtColPositions),
          getAsList(pkColumns) as List,  getAsList(ukColumns) as List, [] as List, removeDupTableData);
}

def hasMoreResults = true;
def firstBatch = true;

while(hasMoreResults) {

   byte[] data = getBytes(getNextBatch(rs, batchSize, rsColNames));

   if (data==null || data.size() == 0) break;
     
    if("D".equalsIgnoreCase("<% out.print(tgtType); %>")) {
        def datasetSendModel = new BICSDataLoadDatasetModel();
        reqData = datasetSendModel.getDataloadDatasetJson(getAsList(expressionTargetMappingPositions), getAsList(tgtColNames), getAsList(tgtColTypes), 
            getAsList(tgtColLengths), getAsList(tgtColScales), getAsList(tgtColPositions), firstBatch, 
            (numRecordsFromResultSet < batchSize));
    }
    
    logInfo(reqData.toString());
    
    firstBatch = false;

    ByteArrayOutputStream responseStream;

    int batchNumRetries = numRetries;
    while(batchNumRetries >= 0) {
        try {
            def topPart = new RestReqBodyPart("top", IOUtils.toInputStream(reqData.toString()));
            topPart.setBodyPartContentType("application/json");
            def dataPart = new RestReqBodyPart("data", new ByteArrayInputStream(data));
            dataPart.setBodyPartContentType("application/octet-stream");
            responseStream = new ByteArrayOutputStream(256);
            invokeRESTSendData(topPart, dataPart, responseStream);
            break;
        } catch (Exception ex) {
            logInfo(ex.toString());
            logInfo("Number of retries available = " + batchNumRetries);
            if (batchNumRetries <= 0) {
                throw new OdiKMException("ODIKM-BICS-1000", convertExceptionToString(ex));
	    }
        }
        --batchNumRetries;
        Thread.sleep((retryDelaySecs * 1000));
    }

    String bicsStats = responseStream == null ? "{}" : responseStream.toString("UTF-8");
    logInfo(bicsStats);
    
    //BICS returns statistics only for Tables
    if("T".equalsIgnoreCase("<% out.print(tgtType); %>")) {        
        recStats.append(bicsStats);
        recStats.append(",\n");        
    }

    //Exit loading if current batch fails.
    if ("T".equalsIgnoreCase("<% out.print(tgtType); %>") && loadingFailed(bicsStats)) break;       

    if(numRecordsFromResultSet < batchSize)
        hasMoreResults = false;
                

}
recStats.append("] }");

boolean loadingFailed(String response) {
    JSONObject statsContainer = new JSONObject(response); 
    def status = statsContainer.getString("status"); 
    return status!=null && "Failed".equalsIgnoreCase(status);
}

@Field long insertedRows = 0;
@Field long updatedRows = 0;
@Field long startTimeMiliseconds = 0;
@Field long endTimeMiliseconds = 0;
@Field long duration = 0;
@Field long failedRows = 0;

void processStatistics(statsString) {
    JSONObject statsContainer = new JSONObject(statsString); 
    JSONArray statsArray = statsContainer.get(STATS);
    for (int i = 0; i < statsArray.length(); i++) {
	insertedRows += statsArray.getJSONObject(i).getInt(STATS_INSERTED_ROWS);
	updatedRows += statsArray.getJSONObject(i).getInt(STATS_UPDATED_ROWS);
        failedRows += statsArray.getJSONObject(i).getInt(STATS_FAILED_ROWS);
        if(startTimeMiliseconds <= 0)
	    startTimeMiliseconds = statsArray.getJSONObject(i).getLong(STATS_START_TIME);
	endTimeMiliseconds = statsArray.getJSONObject(i).getLong(STATS_END_TIME);
        duration += (endTimeMiliseconds - startTimeMiliseconds);
    }
}
processStatistics(recStats.toString());

odiRef.setNbInsert(insertedRows);
odiRef.setNbUpdate(updatedRows);
odiRef.setNbDelete(0);
odiRef.setNbErrors(failedRows);
odiRef.setNbRows(insertedRows + updatedRows + failedRows);

logInfo("Number of rows inserted:" + insertedRows);
logInfo("Number of rows updated:" + updatedRows);   
logInfo("Number of rows in error:" + failedRows);   

rs.close();
stmt.close();]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c8e48d05-cc4d-4c7e-9aa7-4ccc9ef49044]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[640]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a1e1b0da-0ba2-4df0-9dc6-85049e0ed16e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[640]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e4bfac83-7e1d-4530-a76d-da3b2168434a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[640]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[13aee07d-f808-44e2-9df7-af5b6ec9e64b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[640]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[093e1f06-ba1e-4470-95b7-a30f7c46a4c6]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[641]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[5420eb13-2562-45f5-86ca-89de3e671bb1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[642]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[054292ef-5ee9-475f-94fc-c85eff1f537b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[643]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[571b0c7d-1bf7-4044-a044-0b8c1a374d38]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[644]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[d56ca643-1b2a-43b8-be49-e555a17757a6]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[644]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[cc61892c-8f39-46c7-9d87-1c457c3a77f2]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[644]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[36f3909c-6c6e-45b9-8bd7-c78c2925bc9b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[644]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[566662a9-d2c8-4530-8b1c-7f19fd798ed3]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[645]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ac78b14e-000a-47eb-86f3-3ab231dc41ca]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[645]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[fa3ebc33-5e8b-4acb-accf-b4a27b8ac210]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[645]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[be60c679-0c15-42a5-80d2-27bb25ab38b5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[645]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e12aa5a7-0348-4c4e-9914-17c7df35bbb0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[646]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[89ae4e30-0f43-425c-a980-77d9962b1d8d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[646]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2b82d23c-7d5e-455b-83b2-f7cbdbf0b6eb]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[646]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[7f6411af-b502-43cc-b46f-4e6c9e14cab5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[646]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1573]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3de65d9a-4c39-4846-9ee3-627cc0ca3dac]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.164]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[04841340-af98-452e-bcec-0485c599a651]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1574]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[90c82f92-7ed9-4726-82c2-c44f45c3aaf7]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1575]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b3e482de-431f-48b9-8e7f-448766991295]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.110]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1576]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4a3538c6-0fdc-4e44-b268-05c4759e6a13]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1577]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[54be4271-fb3d-45a3-a5f9-f844eec43643]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1578]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[edb6fc5f-b5ea-46c4-b805-3cc359772ab0]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1579]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[01e3b39c-1ad1-462e-a4f7-540ac3a8d1d4]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.102]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1580]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4e4c63ea-d73c-4f65-9ae1-9e1a56a0a7dd]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1581]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[82f5dac7-a7f0-49cd-b2e5-67f7eeff1ad1]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.103]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1582]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[20c9c7bc-2bbd-4a30-8025-ab58c5274a5c]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.1583]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2d32cc45-f292-4f61-ae0d-5cc5e3d4fe85]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.604]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ae0142d8-20f2-4f16-b809-f55faf086c52]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.CREATE_TARGET]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_USEREXIT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.13]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.640]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[48a3a155-ea7b-4426-8139-3d39cc6de4f4]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Lock Journalized Table]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.22]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.609]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[26753578-f4db-4b40-a3ba-7c41b31c2426]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.REMOVE_DUPLICATES]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_USEREXIT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.17]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.603]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[dff777d4-6611-4f86-bae7-8fde0cb565cc]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.TRUNCATE_TARGET_TABLE]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_USEREXIT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.21]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.605]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[98fdf1d4-abf7-4454-938a-cebeb8112526]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.DROP_TARGET]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_USEREXIT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.11]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.641]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c4c1bad4-4455-4502-97d9-67ba4cba529e]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Drop target]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.11]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.642]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e966f689-d441-4cd8-8e46-64743d452aea]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Truncate target table]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.21]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.643]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[cdfdf150-6a7e-46dd-be49-9d39eaf00a0f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Create target]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.13]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.644]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[32f2b0bf-8ba2-4182-9a37-aa929d775e9f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Cleanup Journalized Table]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.25]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.645]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e9906a23-078b-493c-bad6-bc96148a4056]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Prepare for loading]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.19]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.646]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ae3857b7-6d4c-4a83-b088-1b67a4c9c19f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[IKM SQL to Oracle BI Cloud Service.Load data into Oracle BICS]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_TRT.SNP_LINETRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[34.26]]></Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[37]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.07]]></Field>
</Object>
</SunopsisExport>
